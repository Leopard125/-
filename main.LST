C51 COMPILER V9.00   MAIN                                                                  12/11/2022 19:33:26 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          // 左边马达，当IN1=0，IN2=1时为反转。IN1=1，IN2=0时为正转。待机则全为0，刹车则全为1
   2          // 右边马达，当IN3=1，IN4=0时为反转。IN3=0，IN4=1时为正转
   3          
   4          // 红外传感器：有信号为1  没有信号为0    灯亮，没有黑线，灯灭，有黑线
   5          # include <reg51.h>
   6          
   7          // 左电机
   8          sbit IN1 = P2^0;
   9          sbit IN2 = P2^1;
  10          sbit ENA = P2^2;
  11          
  12          // 右电机
  13          sbit IN3 = P2^3;
  14          sbit IN4 = P2^4;
  15          sbit ENB = P2^5;
  16          
  17          // 红外传感器
  18          sbit LEFT_2 = P1^3;
  19          sbit LEFT_1 = P1^4;
  20          sbit CENTER = P1^5;
  21          sbit RIGHT_1 = P1^6;
  22          sbit RIGHT_2 = P1^7;
  23          
  24          void delay(int t);
  25          
  26          // 车的运动状态
  27          void forward(void);
  28          void backward(void);
  29          void right(void);
  30          void left(void);
  31          void idle(void);
  32          
  33          // 车传感器的状态
  34          int isLeft(void);
  35          int isRight(void);
  36          
  37          void main(void)
  38          {
  39   1              ENA = 1;
  40   1              ENB = 1;
  41   1              if(isLeft()){
  42   2                      right();
  43   2                      delay(1);
  44   2              }
  45   1              else if(isRight()){
  46   2                      left();
  47   2                      delay(1);
  48   2              }
  49   1              else if(isLeft()&&isRight()){
  50   2                      idle();
  51   2              }else{
  52   2                      forward();
  53   2              }
  54   1      }
  55          
C51 COMPILER V9.00   MAIN                                                                  12/11/2022 19:33:26 PAGE 2   

  56          // 先不上PWM
  57          void forward()
  58          {// 左正右正
  59   1              IN1 = 1;
  60   1              IN2 = 0;
  61   1              IN3 = 0;
  62   1              IN4 = 1;
  63   1      }
  64          
  65          void right()
  66          {// 左正右停
  67   1              IN1 = 1;
  68   1              IN2 = 0;
  69   1              IN3 = 0;
  70   1              IN4 = 0;
  71   1      }
  72          
  73          void left()
  74          {// 左停右正
  75   1              IN1 = 0;
  76   1              IN2 = 0;
  77   1              IN3 = 0;
  78   1              IN4 = 1;
  79   1      }
  80          
  81          void backward()
  82          {// 左反右反
  83   1              IN1 = 0;
  84   1              IN2 = 1;
  85   1              IN3 = 1;
  86   1              IN4 = 0;
  87   1      }
  88          
  89          void idle()
  90          {// 左停右停
  91   1              IN1 = 0;
  92   1              IN2 = 0;
  93   1              IN3 = 0;        
  94   1              IN4 = 0;
  95   1      }
  96          
  97          void delay(int t)
  98          {
  99   1              int i,j;
 100   1              for(i=0;i<t;i++){
 101   2                      for(j=0;j<120;j++);     // 1ms
 102   2              }
 103   1      }
 104          
 105          int isLeft()
 106          {
 107   1              int chk = 0;
 108   1              if(RIGHT_1==1 && LEFT_1==0){     // 右边踩线，左偏
 109   2                      chk = 1;        
 110   2              }else chk = 0;
 111   1              return chk;
 112   1      }
 113          
 114          int isRight()
 115          {
 116   1              int chk = 0;
 117   1              if(RIGHT_1==0 && LEFT_1==1){     // 左边踩线，右偏
C51 COMPILER V9.00   MAIN                                                                  12/11/2022 19:33:26 PAGE 3   

 118   2                      chk = 1;        
 119   2              }else chk = 0;
 120   1              return chk;
 121   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    169    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
